<!DOCTYPE html>
<meta charset="utf-8" name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<!-- three.js library -->
<script src="../vendor/threejs/three.js"></script>


<!-- ar.js lib -->
<script src="../vendor/arjs/ar.js"></script>
<script>THREEx.ArToolkitContext.baseURL = '../'</script>
<head>
    <style>
        body {
            margin: 0 auto;
        }
        .dislog {
            position: fixed;
            z-index: 999;
            width: 100%;
            height: 100%;
            /*display: none;*/
            text-align: center;
            /*background-color: #000;*/
            opacity: 1;
        }
        /*状态*/

        .list {
            position: relative;
            width: 100%;
            height: 70px;
        }

        .dis_cont {
            position: relative;
            border-radius: 10px;
            top: 40%;
            width: 80%;
            display: inline-block;
            height: 160px;
            background-color: #7CE1FB;
        }
        /*确认取消*/

        .dis_bott {
            position: absolute;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            border-top: 1px solid #ddd;
            width: 100%;
            height: 70px;
            background-color: #f5f5f5;
            bottom: 0px;
        }
        /*取消按钮*/

        .left_name {
            position: absolute;
            border-bottom-left-radius: 10px;
            text-align: center;
            left: 0px;
            width: 50%;
            height: 70px;
            line-height: 70px;
            background-color: #fff;
        }
        /*确认*/

        .right_name {
            position: absolute;
            text-align: center;
            border-bottom-right-radius: 10px;
            right: 0px;
            width: 49%;
            height: 70px;
            line-height: 70px;
            background-color: #fff;
        }
        /* 提示*/

        .cont_dis {
            position: relative;
            border-radius: 10px;
            text-align: center;
            width: 100%;
            height: 90px;
            font-size: 20px;
            display: flex;
            align-items: center;
            color: #fff;
            box-sizing: border-box;
            padding: 20px 20px;
        }
    </style>
</head>

<body style='margin : 0px; overflow: hidden; font-family: Monospace;'>
<div id="back">
    <img height=50 width=50 src="images/back.png" onclick="window.open('index.html','_self')">
</div>
<div style="width: 100%;height: 100%">
    <img style="width: 400px;height: 400px;position: absolute;top: 0;bottom: 0;left: 0;right: 0;margin: auto;" src="images/biankuang.png">
</div>
<!--/**************************tanchuang***********************************/-->

<div id="lianwen" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            莲纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('lianhua.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="juancao" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            卷草纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('juancao.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="feitian" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            飞天纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('feitianwen.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="long" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            龙纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('long.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="bajiaoxing" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            八角星纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('bajiaoxing.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="yingxi" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            婴戏纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('yingxi.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="ruyi" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            如意纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('ruyi.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="hudie" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            蝴蝶纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('hudie.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="wanzi" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            万字纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('wanzi.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<div id="yun" class="dislog" style="display:none;">
    <!--内容-->
    <div class="dis_cont">
        <div class="cont_dis">
            云纹识别成功
        </div>

        <div class="dis_bott">
            <label class="left_name" onclick="cances()">进行AR体验</label>
            <label class="right_name" onclick="window.open('yun.html')">查看纹样介绍</label>

        </div>

    </div>

</div>
<script type="text/javascript" src="js/jquery-2.1.3.min.js" ></script>

<script>
    /********************************弹窗***************************************/
    function shows(id){
        // $(".dislog").css("display","block");
        var target=document.getElementById(id);
        if(target.style.display=="none"){
            target.style.display="";
        }else{
            target.style.display="none";
        }
    }
    //隐藏遮罩弹窗
    /* function nones(){
        $(".dislog").css("display","none");
    }*/
    //取消
    function cances()
    {
        $(".dislog").css("display","none");

    }

    //////////////////////////////////////////////////////////////////////////////////
    //		Init
    //////////////////////////////////////////////////////////////////////////////////

    // init renderer
    var renderer	= new THREE.WebGLRenderer({
        antialias	: true,
        alpha: true
    });
    renderer.setClearColor(new THREE.Color('lightgrey'), 0)
    renderer.setSize( 640, 480 );
    renderer.domElement.style.position = 'absolute'
    renderer.domElement.style.top = '0px'
    renderer.domElement.style.left = '0px'
    document.body.appendChild( renderer.domElement );

    // array of functions for the rendering loop
    var onRenderFcts= [];

    // init scene and camera
    var scene	= new THREE.Scene();

    //////////////////////////////////////////////////////////////////////////////////
    //		Initialize a basic camera
    //////////////////////////////////////////////////////////////////////////////////

    // Create a camera
    var camera = new THREE.Camera();
    scene.add(camera);

    ////////////////////////////////////////////////////////////////////////////////
    //          handle arToolkitSource
    ////////////////////////////////////////////////////////////////////////////////

    var arToolkitSource = new THREEx.ArToolkitSource({
        // to read from the webcam
        sourceType : 'webcam',

        // to read from an image
        // sourceType : 'image',
        // sourceUrl : THREEx.ArToolkitContext.baseURL + '../data/images/img.jpg',

        // to read from a video
        // sourceType : 'video',
        // sourceUrl : THREEx.ArToolkitContext.baseURL + '../data/videos/headtracking.mp4',
    })

    arToolkitSource.init(function onReady(){
        onResize()
    })

    // handle resize
    window.addEventListener('resize', function(){
        onResize()
    })
    function onResize(){
        arToolkitSource.onResizeElement()
        arToolkitSource.copyElementSizeTo(renderer.domElement)
        if( arToolkitContext.arController !== null ){
            arToolkitSource.copyElementSizeTo(arToolkitContext.arController.canvas)
        }
    }
    ////////////////////////////////////////////////////////////////////////////////
    //          initialize arToolkitContext
    ////////////////////////////////////////////////////////////////////////////////

    // create atToolkitContext
    var arToolkitContext = new THREEx.ArToolkitContext({
        cameraParametersUrl: THREEx.ArToolkitContext.baseURL + '../data/camera_para.dat',
        detectionMode: 'mono',
    })
    // initialize it
    arToolkitContext.init(function onCompleted(){
        // copy projection matrix to camera
        camera.projectionMatrix.copy( arToolkitContext.getProjectionMatrix() );
    })

    // update artoolkit on every frame
    onRenderFcts.push(function(){
        if( arToolkitSource.ready === false )	return

        arToolkitContext.update( arToolkitSource.domElement )
    })

    //建立标签和模型
    ;(function(){

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot1 八角星纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot1 = new THREE.Group
        markerRoot1.name = 'marker1'
        scene.add(markerRoot1)
        var markerControls1 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot1, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-bjxw.patt',

        })

        console.log("markerRoot1.visible: ");console.log(markerRoot1.visible);
        if(markerRoot1.visible)
        {
            console.log("jump-------------------");
        }

        // add a gizmo in the center of the marker
        var geometry1	= new THREE.CubeGeometry(1,1,1);
        var material1	= new THREE.MeshNormalMaterial({
            transparent : true,
            opacity: 0.5,
            side: THREE.DoubleSide
        });
        var mesh1	= new THREE.Mesh( geometry1, material1 );
        mesh1.position.y	= geometry1.parameters.height/2
        markerRoot1.add( mesh1 );

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot2 飞天纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot2 = new THREE.Group
        markerRoot2.name = 'marker2'
        scene.add(markerRoot2)
        var markerControls2 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot2, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-ftw.patt',
        })

        // add a gizmo in the center of the marker

        var geometry2	= new THREE.TorusKnotGeometry(0.1,0.1,16,16);
        var material2	= new THREE.MeshNormalMaterial();
        var mesh2	= new THREE.Mesh( geometry2, material2 );
        mesh2.position.y	= 0.5
        markerRoot2.add( mesh2 );

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot3 蝴蝶纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot3 = new THREE.Group
        markerRoot3.name = 'marker3'
        scene.add(markerRoot3)
        var markerControls3 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot3, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-hdw.patt',
        })

        // add a gizmo in the center of the marker
        var geometry3	= new THREE.OctahedronGeometry( 0.3, 0 )
        var material3	= new THREE.MeshNormalMaterial({
            wireframe: true
        });
        var mesh3	= new THREE.Mesh( geometry3, material3 );
        markerRoot3.add( mesh3 );

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot4 卷草纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot4 = new THREE.Group
        markerRoot4.name = 'marker4'
        scene.add(markerRoot4)
        var markerControls4 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot4, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-jcw2.patt',
        })

        // add a gizmo in the center of the marker
        var geometry4	= new THREE.OctahedronGeometry( 0.4, 0 )
        var material4	= new THREE.MeshNormalMaterial({
            wireframe: true
        });
        var mesh4	= new THREE.Mesh( geometry4, material4 );
        markerRoot4.add( mesh4 );

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot5 莲花纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot5 = new THREE.Group
        markerRoot5.name = 'marker5'
        scene.add(markerRoot5)
        var markerControls5 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot5, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-lhw.patt',
        })

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot6 龙纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot6 = new THREE.Group
        markerRoot6.name = 'marker6'
        scene.add(markerRoot6)
        var markerControls6 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot6, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-longw.patt',
        })

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot7 如意纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot7 = new THREE.Group
        markerRoot7.name = 'marker7'
        scene.add(markerRoot7)
        var markerControls7 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot7, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-ryw.patt',
        })

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot8 万字纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot8 = new THREE.Group
        markerRoot8.name = 'marker8'
        scene.add(markerRoot8)
        var markerControls8 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot8, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-wzw.patt',
        })

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot9 婴嬉纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot9 = new THREE.Group
        markerRoot9.name = 'marker9'
        scene.add(markerRoot9)
        var markerControls9 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot9, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-yxw.patt',
        })

        //////////////////////////////////////////////////////////////////////////////
        //		markerRoot10 云纹
        //////////////////////////////////////////////////////////////////////////////

        // build markerControls
        var markerRoot10 = new THREE.Group
        markerRoot10.name = 'marker10'
        scene.add(markerRoot10)
        var markerControls10 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot10, {
            type : 'pattern',
            patternUrl : THREEx.ArToolkitContext.baseURL + '../markerfiles/pattern-yw.patt',
        })

    })()


    //识别控制
    ;(function(){
        var markerRoot1 = scene.getObjectByName('marker1')
        var markerRoot2 = scene.getObjectByName('marker2')
        var markerRoot3 = scene.getObjectByName('marker3')
        var markerRoot4 = scene.getObjectByName('marker4')
        var markerRoot5 = scene.getObjectByName('marker5')
        var markerRoot6 = scene.getObjectByName('marker6')
        var markerRoot7 = scene.getObjectByName('marker7')
        var markerRoot8 = scene.getObjectByName('marker8')
        var markerRoot9 = scene.getObjectByName('marker9')
        var markerRoot10 = scene.getObjectByName('marker10')

        // var container = new THREE.Group
        // scene.add(container)

        var isFirst1 = true;
        var isFirst2 = true;
        var isFirst3 = true;
        var isFirst4 = true;
        var isFirst5 = true;
        var isFirst6 = true;
        var isFirst7 = true;
        var isFirst8 = true;
        var isFirst9 = true;
        var isFirst10 = true;


        // update container.visible and scanningSpinner visibility
        onRenderFcts.push(function(){
            if(markerRoot1.visible && isFirst1)
            {
                shows('bajiaoxing');
                isFirst1 = false;
            }
            if(markerRoot2.visible && isFirst2)
            {
                shows('feitian');
                isFirst2 = false;
            }
            if(markerRoot3.visible && isFirst3)
            {
                shows('hudie');
                isFirst3 = false;
            }
            if(markerRoot4.visible && isFirst4)
            {
                shows('juancao');
                isFirst4 = false;
            }
            if(markerRoot5.visible && isFirst5)
            {
                shows('lianwen');
                isFirst5 = false;
            }
            if(markerRoot6.visible && isFirst6)
            {
                shows('long');
                isFirst6 = false;
            }
            if(markerRoot7.visible && isFirst7)
            {
                shows('ruyi');
                isFirst7 = false;
            }
            if(markerRoot8.visible && isFirst8)
            {
                shows('wanzi');
                isFirst8 = false;
            }
            if(markerRoot9.visible && isFirst9)
            {
                shows('yingxi');
                isFirst9 = false;
            }
            if(markerRoot10.visible && isFirst10)
            {
                shows('yun');
                isFirst10 = false;
            }
        })



    })()
    //////////////////////////////////////////////////////////////////////////////////
    //		render the whole thing on the page
    //////////////////////////////////////////////////////////////////////////////////

    // render the scene
    onRenderFcts.push(function(){
        renderer.render( scene, camera );
    })

    // run the rendering loop
    var lastTimeMsec= null
    requestAnimationFrame(function animate(nowMsec){
        // keep looping
        requestAnimationFrame( animate );
        // measure time
        lastTimeMsec	= lastTimeMsec || nowMsec-1000/60
        var deltaMsec	= Math.min(200, nowMsec - lastTimeMsec)
        lastTimeMsec	= nowMsec
        // call each update function
        onRenderFcts.forEach(function(onRenderFct){
            onRenderFct(deltaMsec/1000, nowMsec/1000)
        })
    })
</script>



</body>
